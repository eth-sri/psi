// skipped

n := 3; // TODO: loops.

def logâ‚‚(x)=>log(x)/log(2);

def S[a](d: Distribution[a], x: a, eq: aÃ—aâ†’ â„)â‡’
	logâ‚‚(1/expectation(infer(()â‡’ eq(sample(d),x))));

def H[a](d: Distribution[a], eq: aÃ—aâ†’ â„)â‡’
	expectation(infer(()â‡’ S(d,sample(d),eq)));

def Ï€â‚[a,b](d: Distribution[aÃ—b])â‡’ infer(()=>sample(d)[0]);
def Ï€â‚‚[a,b](d: Distribution[aÃ—b])â‡’ infer(()=>sample(d)[1]);

def I[a,b](d: Distribution[aÃ—b], eqâ‚: aÃ—aâ†’ð”¹, eqâ‚‚: bÃ—bâ†’ð”¹)â‡’
	  H(Ï€â‚(d),eqâ‚) + H(Ï€â‚‚(d),eqâ‚‚) - H(d,eq_p(eqâ‚,eqâ‚‚));

def independent[a,b](d: Distribution[aÃ—b],eqâ‚: aÃ—aâ†’ð”¹, eqâ‚‚: bÃ—bâ†’ð”¹){
	return I(d,eqâ‚,eqâ‚‚)==0;
}

def main(){
	return (independent(infer((){a:=flip(1/2); return (a,a); }),eqâ„,eqâ„),
			independent(infer(()â‡’(flip(1/2),flip(1/3))),eqâ„,eqâ„));
}


def eq_p[a,b](eqa:aÃ—aâ†’ð”¹,eqb:bÃ—bâ†’ð”¹)(x:aÃ—b,y:aÃ—b)â‡’
	eqa(x[0],y[0])&&eqb(x[1],y[1]);
def eqâ„(x,y)=>x==y;
