// skipped

def main(x:â„){
    return H(infer((){
        seq := array(4,0);
        seq[0] = flip(1/2);
        for i in [1..4){
            seq[i] = seq[i-1] âŠ• flip(x);
        }
        return seq;
    }),eq_a(eqâ„));
}

def logâ‚‚(x)=>log(x)/log(2);

def S[a](d: Distribution[a], x: a, eq: aÃ—aâ†’ â„) â‡’
	-logâ‚‚(expectation(infer((){
		y := sample(d);
		return eq(x,y);
	})));

def H[a](d: Distribution[a], eq: aÃ—aâ†’â„) â‡’ expectation(infer((){ x := sample(d); return S(d,x,eq); }));


def eqâ„(x,y)=>x==y;
def eq_a[a](eq: aÃ—aâ†’ğ”¹)(x: a[],y: a[]){
	for i in [0..4){
		if !eq(x[i],y[i]){
			return false;
		}
	}
	return true;
}
def eq_p[a,b](eqa:aÃ—aâ†’ğ”¹,eqb:bÃ—bâ†’ğ”¹)(x:aÃ—b,y:aÃ—b)â‡’
	eqa(x[0],y[0])&&eqb(x[1],y[1]);

def eq_t[a,b,c](eqa: aÃ—aâ†’ğ”¹, eqb: bÃ—bâ†’ğ”¹, eqc: cÃ—câ†’ğ”¹)(x:aÃ—bÃ—c,y:aÃ—bÃ—c)â‡’
	eqa(x[0],y[0])&&eqb(x[1],y[1])&&eqc(x[2],y[2]);



/+
def main(){
    a := [uniform(0,2), uniformInt(1,3)/3];
    x := a[flip(1/2)];
    p := infer((){
        y := uniform(0,1);
        observe(y <= x);
        return y;
    });
    return (expectation(p), sample(p));
}
+/
/+def main(){
    x := flip(1/2) + uniform(0,1/2);
    p := infer((){
        y := uniform(0,1);
        observe(y <= x);
        return y;
    });
    return (expectation(p), sample(p));
}+/



/+def main(){
	x := uniform(0,1);
	z := flip(1/2);
	p := infer((){
		y := uniform(0,1);
		observe(x+y<=z+1);
		return y;
	});
	return (x, sample(p));
}+/

/*
// old example
def main(){
  x := uniform(0,1);
  y := uniform(0,1);
  z := x + y;
  observe(z <= 1);
  return x;
}*/
