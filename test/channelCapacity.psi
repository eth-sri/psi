// skipped
// TODO: make fast
import genCap;

def informationFlow[a,b](input: Distribution[a], channel: aâ†’ b,eqa: aÃ—aâ†’ğ”¹,eqb: bÃ—bâ†’ğ”¹)â‡’
I(infer((){
	i := sample(input);
	o := channel(i);
	return (i,o);
}),eqa,eqb);

def bsc(q)â‡’(b)â‡’bâŠ•flip(q);

/+def main(/+p,q+/q){
	input := infer(()â‡’ flip(p));
	channel := bsc(q);
	return informationFlow(input, channel, eqâ„,eqâ„);
}+/

def main(n,q){
	/+n := 5; 
	input := infer(()â‡’ uniformInt(0,n));+/ // TODO: get rid of sums in result
	input := UniformInt(0,n);
	channel := (i)â‡’ if flip(q) then
	                   if flip(1/2) then (i-1)%n
	                                else (i+1)%n
	                else i;
	return informationFlow(input, channel, eqâ„, eqâ„);
}
